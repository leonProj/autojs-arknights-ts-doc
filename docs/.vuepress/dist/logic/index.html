<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.53">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo.png"><title>项目逻辑 | autojs-arknights-ts</title><meta name="description" content="明日方舟周收菜脚本，autojsPro9,nodejs，vue2，vant">
    <link rel="preload" href="/autojs-arknights-ts-doc/assets/style.d051fda5.css" as="style" /><link rel="stylesheet" href="/autojs-arknights-ts-doc/assets/style.d051fda5.css" />
    <link rel="modulepreload" href="/autojs-arknights-ts-doc/assets/app.c897fe6e.js"><link rel="modulepreload" href="/autojs-arknights-ts-doc/assets/index.html.9e549b7e.js"><link rel="modulepreload" href="/autojs-arknights-ts-doc/assets/index.html.745cb387.js"><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.fa455573.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.8d7e4fdc.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.f18d6466.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.72d5412d.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.99183339.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.3dfcb788.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.4724f08b.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/404.html.c3e557d0.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.34711f30.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.212538fa.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.413e578c.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.3c671503.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.7a38e0b3.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.f84a5321.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/index.html.2da87aa8.js" as="script" /><link rel="prefetch" href="/autojs-arknights-ts-doc/assets/404.html.eb9347ae.js" as="script" />
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container" data-v-58f3c860><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/autojs-arknights-ts-doc/" class=""><img class="logo" src="/autojs-arknights-ts-doc/images/logo.png" alt="autojs-arknights-ts"><span class="site-name can-hide">autojs-arknights-ts</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="个人链接"><span class="title">个人链接</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="个人链接"><span class="title">个人链接</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://space.bilibili.com/95667314" rel="noopener noreferrer" target="_blank" aria-label="b站"><!--[--><!--]--> b站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.douyin.com/user/MS4wLjABAAAAVaIKYLt5SGqOtvh-Sd6n8LZowfI8mB49xePkGsGq8P59Rwon9LeRGifG8LfBqu4p" rel="noopener noreferrer" target="_blank" aria-label="抖音"><!--[--><!--]--> 抖音 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="友情链接"><span class="title">友情链接</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="友情链接"><span class="title">友情链接</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://pro.autojs.org/docs/" rel="noopener noreferrer" target="_blank" aria-label="autojsPro9"><!--[--><!--]--> autojsPro9 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://vant-contrib.gitee.io/vant/v2/#/zh-CN/" rel="noopener noreferrer" target="_blank" aria-label="vant2"><!--[--><!--]--> vant2 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://cn.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="vuejs"><!--[--><!--]--> vuejs <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://discord.gg/PC2tCFDrFG" rel="noopener noreferrer" target="_blank" aria-label="discord"><!--[--><!--]--> discord <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/leonProj/autojs-arknights-ts" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="个人链接"><span class="title">个人链接</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="个人链接"><span class="title">个人链接</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://space.bilibili.com/95667314" rel="noopener noreferrer" target="_blank" aria-label="b站"><!--[--><!--]--> b站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.douyin.com/user/MS4wLjABAAAAVaIKYLt5SGqOtvh-Sd6n8LZowfI8mB49xePkGsGq8P59Rwon9LeRGifG8LfBqu4p" rel="noopener noreferrer" target="_blank" aria-label="抖音"><!--[--><!--]--> 抖音 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="友情链接"><span class="title">友情链接</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="友情链接"><span class="title">友情链接</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://pro.autojs.org/docs/" rel="noopener noreferrer" target="_blank" aria-label="autojsPro9"><!--[--><!--]--> autojsPro9 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://vant-contrib.gitee.io/vant/v2/#/zh-CN/" rel="noopener noreferrer" target="_blank" aria-label="vant2"><!--[--><!--]--> vant2 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://cn.vuejs.org/" rel="noopener noreferrer" target="_blank" aria-label="vuejs"><!--[--><!--]--> vuejs <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://discord.gg/PC2tCFDrFG" rel="noopener noreferrer" target="_blank" aria-label="discord"><!--[--><!--]--> discord <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/leonProj/autojs-arknights-ts" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/autojs-arknights-ts-doc/introduce/" class="sidebar-item sidebar-heading" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a><!----></li><li><a href="/autojs-arknights-ts-doc/start/" class="sidebar-item sidebar-heading" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="/autojs-arknights-ts-doc/question/" class="sidebar-item sidebar-heading" aria-label="疑问解答"><!--[--><!--]--> 疑问解答 <!--[--><!--]--></a><!----></li><li><a href="/autojs-arknights-ts-doc/structure/" class="sidebar-item sidebar-heading" aria-label="项目结构"><!--[--><!--]--> 项目结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/autojs-arknights-ts-doc/logic/" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="项目逻辑"><!--[--><!--]--> 项目逻辑 <!--[--><!--]--></a><!----></li><li><a href="/autojs-arknights-ts-doc/gameLogic/" class="sidebar-item sidebar-heading" aria-label="游戏处理逻辑"><!--[--><!--]--> 游戏处理逻辑 <!--[--><!--]--></a><!----></li><li><a href="/autojs-arknights-ts-doc/ui/" class="sidebar-item sidebar-heading" aria-label="界面交互"><!--[--><!--]--> 界面交互 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--[--><div class="toc-wrapper" data-v-58f3c860><b data-v-58f3c860>本页目录</b><nav class="vuepress-toc" data-v-58f3c860><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#流程图" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="流程图">流程图</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#路由" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="路由">路由</a><!--[--><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#是什么" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="是什么">是什么</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#处理逻辑规范" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="处理逻辑规范">处理逻辑规范</a><!--[--><!--]--></li></ul><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#初始化" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="初始化">初始化</a><!--[--><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#主要代码" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="主要代码">主要代码</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#什么是小图" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="什么是小图？">什么是小图？</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#小图的坐标怎么办" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="小图的坐标怎么办？">小图的坐标怎么办？</a><!--[--><!--]--></li></ul><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#是否有流程没完成" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="是否有流程没完成">是否有流程没完成</a><!--[--><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#主要代码-1" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="主要代码">主要代码</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#是否完成判断" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="是否完成判断">是否完成判断</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#流程顺序" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="流程顺序">流程顺序</a><!--[--><!--]--></li></ul><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#截屏并且识别文字" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="截屏并且识别文字">截屏并且识别文字</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/autojs-arknights-ts-doc/logic/#路由匹配" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="路由匹配">路由匹配</a><!--[--><!--]--></li></ul></nav></div><!--]--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="项目逻辑" tabindex="-1"><a class="header-anchor" href="#项目逻辑" aria-hidden="true">#</a> 项目逻辑</h1><h2 id="流程图" tabindex="-1"><a class="header-anchor" href="#流程图" aria-hidden="true">#</a> 流程图</h2><!--[--><br><img alt="image.png" src="/autojs-arknights-ts-doc/images/logic/img.png"><br><!--]--><div class="custom-container tip"><p class="custom-container-title">提示</p><p>下面会对流程中的每个步骤进行详细的说明</p></div><h2 id="路由" tabindex="-1"><a class="header-anchor" href="#路由" aria-hidden="true">#</a> 路由</h2><h3 id="是什么" tabindex="-1"><a class="header-anchor" href="#是什么" aria-hidden="true">#</a> 是什么</h3><p>可以理解为页面，比如公招页面，基建页面，主界面。根据关键字判断是在哪个页面，再执行对应的action逻辑操作。所有的路由在<code>src/router/</code></p><p>一个简单的路由如下</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Route</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * <span class="token keyword">@description</span> 描述这个路由是什么
     */</span>
    describe<span class="token operator">:</span> <span class="token builtin">string</span>
    <span class="token doc-comment comment">/**
     * <span class="token keyword">@description</span> 页面判断关键字
     */</span>
    keywords<span class="token operator">:</span> RouterKeywords
    <span class="token doc-comment comment">/**
     * <span class="token keyword">@description</span> 页面处理逻辑
     */</span>
    action<span class="token operator">:</span> RouterAction
<span class="token punctuation">}</span>

<span class="token keyword">const</span> main<span class="token operator">:</span> Route<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        describe<span class="token operator">:</span> <span class="token string">&#39;明日方舟开始的start界面&#39;</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token punctuation">{</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;CADPAVer&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;网络检测&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;清除缓存&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">action</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">clickCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        describe<span class="token operator">:</span> <span class="token string">&#39;明日方舟登录开始唤醒界面&#39;</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token punctuation">{</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;鹰角网络&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;账号管理&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;用户协议&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">action</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>ocrResult<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">clickByHrOcrResultAndText</span><span class="token punctuation">(</span>ocrResult<span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="处理逻辑规范" tabindex="-1"><a class="header-anchor" href="#处理逻辑规范" aria-hidden="true">#</a> 处理逻辑规范</h3><p>由于某些操作会发送请求，而由于网络的不稳定性，不能简单的用延时几秒来处理这个路由。所以一个路由的操作一般都是点击触发请求之后就结束了。剩余的操作由下次截图路由处理。</p><p>举个栗子,假如我想要开始唤醒之后，直接点击公开招募</p><p>错误的写法❌</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>  <span class="token keyword">const</span> main<span class="token operator">:</span> Route<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        describe<span class="token operator">:</span> <span class="token string">&#39;明日方舟登录开始唤醒界面&#39;</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token punctuation">{</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;鹰角网络&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;账号管理&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;用户协议&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">action</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>ocrResult<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">clickByHrOcrResultAndText</span><span class="token punctuation">(</span>ocrResult<span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 这里延时2秒来作为loading的时间，是不合理的，错误的，因为网络不稳定，可能会导致延时不够</span>
            <span class="token keyword">await</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token comment">// 导致下面的点击公开招募在没进入主界面之后就提前触发了</span>
            <span class="token keyword">await</span> <span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&#39;公开招募的坐标&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>正确的写法✔️</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>  <span class="token keyword">const</span> main<span class="token operator">:</span> Route<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        describe<span class="token operator">:</span> <span class="token string">&#39;明日方舟登录开始唤醒界面&#39;</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token punctuation">{</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;鹰角网络&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;账号管理&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;用户协议&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">action</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>ocrResult<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">clickByHrOcrResultAndText</span><span class="token punctuation">(</span>ocrResult<span class="token punctuation">,</span> <span class="token string">&#39;开始唤醒&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        describe<span class="token operator">:</span> <span class="token string">&#39;明日方舟主界面&#39;</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token punctuation">{</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;档案&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;采购中心&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公开招募&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;干员寻访&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;任务&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;基建&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;好友&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">action</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>ocrResult<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">clickByHrOcrResultAndText</span><span class="token punctuation">(</span>ocrResult<span class="token punctuation">,</span> <span class="token string">&#39;公开招募&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意动画效果延时 ❗</p><p>虽然点击home按钮，再点击首页按钮。这两个操作之间没有发送请求，可以连续操作，但是请注意给个延时。点击home按钮之后会有几百毫秒的下拉动画的。不延时直接连续点击是点不到的</p><!--[--><br><img alt="image.png" src="/autojs-arknights-ts-doc/images/logic/img_1.png" width="300"><br><!--]--><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 点击家按钮，再点击首页
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">backHomePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 点击home按钮</span>
    <span class="token keyword">await</span> <span class="token function">clickHome</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 等待下拉动画</span>
    <span class="token keyword">await</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token comment">// 点击首页</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">0.0733</span> <span class="token operator">*</span> <span class="token punctuation">(</span>deviceInfo<span class="token punctuation">.</span>longSide <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token number">0.389</span> <span class="token operator">*</span> <span class="token punctuation">(</span>deviceInfo<span class="token punctuation">.</span>shortSide <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">点击首页</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">click</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">点击了坐标</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="初始化" tabindex="-1"><a class="header-anchor" href="#初始化" aria-hidden="true">#</a> 初始化</h2><h3 id="主要代码" tabindex="-1"><a class="header-anchor" href="#主要代码" aria-hidden="true">#</a> 主要代码</h3><p><code>src/main/index.ts</code> 初始化一些设备信息，一些常用对象等。</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 是否开启无障碍判断</span>
    <span class="token comment">// 初始化</span>
    <span class="token comment">// 初始化未找到路由页面的次数</span>
    <span class="token comment">// 请求截图权限</span>
    <span class="token comment">// 创建OCR对象</span>
    <span class="token comment">// 启动游戏</span>
    <span class="token comment">// .......</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>src\utils\commonUtil.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@description</span> 初始化设备信息
 */</span>
<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token comment">/*因为竖屏和横屏下，宽高值不一样所以统一成下面的的长边和短边*/</span>
    <span class="token comment">// 设备长边</span>
    <span class="token comment">// 设备短边</span>
    <span class="token comment">// 截屏之后，图片中间被等比缩小的小图高度</span>
    <span class="token comment">// 截屏之后，图片中间被等比缩小的小图宽度</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="什么是小图" tabindex="-1"><a class="header-anchor" href="#什么是小图" aria-hidden="true">#</a> 什么是小图？</h3><p>模拟器截屏的时候有个很操蛋的问题，无论你是横屏还是竖屏，截屏之后图片都是竖屏的,如下所示。</p><!--[--><br><img alt="image.png" src="/autojs-arknights-ts-doc/images/logic/img2.jpg" width="300"><br><!--]--><p>这就导致了一个问题，截图之后文字识别的时候坐标会对应不上。为了解决这个问题，所以需要把中间实际的<code>小图</code>截出来，然后再进行文字识别。这就是<code>小图</code>的由来。</p><p><code>src/main/index.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code> <span class="token comment">// 主程序中调用截图</span>
<span class="token keyword">const</span> capture <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">captureAndClip</span><span class="token punctuation">(</span>capturer<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>src\utils\imageUtil.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 截屏并截取中间小图部分
 * <span class="token keyword">@param</span> <span class="token parameter">screenCapturer</span> 请求截图权限返回的对象
 * <span class="token keyword">@return</span> 截取后的小图
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">captureAndClip</span><span class="token punctuation">(</span>screenCapturer<span class="token operator">:</span> ScreenCapturer<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 截图</span>
    <span class="token comment">// 裁剪</span>
    <span class="token comment">// 释放截图对象</span>
    <span class="token comment">// 返回裁剪后的图片对象</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="小图的坐标怎么办" tabindex="-1"><a class="header-anchor" href="#小图的坐标怎么办" aria-hidden="true">#</a> 小图的坐标怎么办？</h3><p>小图坐标和大图比例是一样的，所以实际的坐标可以计算出来。</p><p><code>src\utils\point.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@description</span> 根据裁剪后的小图中的坐标，返回原来大图中对应的坐标
 * <span class="token keyword">@param</span> <span class="token parameter">smallX</span> 小图中的x坐标
 * <span class="token keyword">@param</span> <span class="token parameter">smallY</span> 小图中的y坐标
 */</span>
<span class="token keyword">function</span> <span class="token function">calOriginalPoint</span><span class="token punctuation">(</span>smallX<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> smallY<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> Point <span class="token punctuation">{</span>
    <span class="token keyword">const</span> originalX <span class="token operator">=</span> deviceInfo<span class="token punctuation">.</span>longSide <span class="token keyword">as</span> <span class="token builtin">number</span> <span class="token operator">/</span> <span class="token punctuation">(</span>deviceInfo<span class="token punctuation">.</span>smallWidth <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">*</span> smallX
    <span class="token keyword">const</span> originalY <span class="token operator">=</span> deviceInfo<span class="token punctuation">.</span>shortSide <span class="token keyword">as</span> <span class="token builtin">number</span> <span class="token operator">/</span> <span class="token punctuation">(</span>deviceInfo<span class="token punctuation">.</span>smallHeight <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">*</span> smallY
    <span class="token keyword">return</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> originalX<span class="token punctuation">,</span> y<span class="token operator">:</span> originalY<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="是否有流程没完成" tabindex="-1"><a class="header-anchor" href="#是否有流程没完成" aria-hidden="true">#</a> 是否有流程没完成</h2><h3 id="主要代码-1" tabindex="-1"><a class="header-anchor" href="#主要代码-1" aria-hidden="true">#</a> 主要代码</h3><p><code>src\main\index.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ......</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取可用的路由列表</span>
        <span class="token keyword">const</span> gameRouter <span class="token operator">=</span> <span class="token function">getGameRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 如果路由为空</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gameRouter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 停止循环</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ......</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="是否完成判断" tabindex="-1"><a class="header-anchor" href="#是否完成判断" aria-hidden="true">#</a> 是否完成判断</h3><!--[--><br><img alt="image.png" src="/autojs-arknights-ts-doc/images/logic/img_2.png" width="700"><br><!--]--><p>上图中四个switch开关就是与这里的值绑定的，关闭代表流程没完成。开启代表流程已完成</p><p><code>src\state\index.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * @Description: 游戏信息
 */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">GameInfo</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * @Description: 是否公招结束 默认false
     */</span>
    isPublicRecruitEnd<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 是否采购中心结束。默认false
     */</span>
    isPurchaseEnd<span class="token operator">:</span><span class="token builtin">boolean</span>

    <span class="token doc-comment comment">/**
     * 是否访问好友结束。默认false
     */</span>
    isFriendHomeEnd<span class="token operator">:</span><span class="token builtin">boolean</span>

    <span class="token doc-comment comment">/**
     * 是否基建流程结束。默认false
     */</span>
    isConstructionEnd<span class="token operator">:</span><span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> gameInfo<span class="token operator">:</span> GameInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    isPublicRecruitEnd<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    isPurchaseEnd<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    isFriendHomeEnd<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    isConstructionEnd<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="流程顺序" tabindex="-1"><a class="header-anchor" href="#流程顺序" aria-hidden="true">#</a> 流程顺序</h3><p><code>sort</code>:流程排序,数字越小越优先执行</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> tasks<span class="token operator">:</span> <span class="token constant">TASKS</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&#39;publicRecruit&#39;</span><span class="token punctuation">,</span>
        flagKey<span class="token operator">:</span> <span class="token string">&quot;isPublicRecruitEnd&quot;</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;公开招募&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公开募&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        sort<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&#39;purchase&#39;</span><span class="token punctuation">,</span>
        flagKey<span class="token operator">:</span> <span class="token string">&quot;isPurchaseEnd&quot;</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token string">&#39;采购中心&#39;</span><span class="token punctuation">,</span>
        sort<span class="token operator">:</span> <span class="token number">4</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&#39;friendHome&#39;</span><span class="token punctuation">,</span>
        flagKey<span class="token operator">:</span> <span class="token string">&quot;isFriendHomeEnd&quot;</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token string">&#39;好友&#39;</span><span class="token punctuation">,</span>
        sort<span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&#39;construction&#39;</span><span class="token punctuation">,</span>
        flagKey<span class="token operator">:</span> <span class="token string">&quot;isConstructionEnd&quot;</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token string">&#39;基建&#39;</span><span class="token punctuation">,</span>
        sort<span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="截屏并且识别文字" tabindex="-1"><a class="header-anchor" href="#截屏并且识别文字" aria-hidden="true">#</a> 截屏并且识别文字</h2><p><code>src/main/index.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ......</span>
    <span class="token comment">// 延迟截图</span>
    <span class="token comment">// 截图</span>
    <span class="token comment">// 文字识别</span>
    <span class="token comment">// 将ocr结果中的文字拼接成字符串</span>
    <span class="token comment">// ......</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="路由匹配" tabindex="-1"><a class="header-anchor" href="#路由匹配" aria-hidden="true">#</a> 路由匹配</h2><p><code>src/main/index.ts</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ......</span>
    <span class="token comment">// 遍历路由</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// 判断路由列表中是否有匹配的</span>
            <span class="token comment">// 如果匹配成功</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// 没找到累计改为0</span>
                    <span class="token comment">// 执行路由中的对应操作</span>
                    <span class="token keyword">await</span> route<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 结束遍历路由</span>
                <span class="token punctuation">}</span>
            <span class="token comment">// 匹配不成功</span>
            <span class="token punctuation">{</span>
                <span class="token comment">// 没找到累计加1</span>
                <span class="token comment">// 如果没找到累计大于等于容错次数</span>
                    <span class="token punctuation">{</span>
                        <span class="token comment">// 运行结束</span>
                    <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token comment">// ......</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/leonProj/autojs-arknights-ts-doc/edit/master/docs/logic/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 501646203@qq.com">DESKTOP-3VSNS1I\leon</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/autojs-arknights-ts-doc/structure/" class="" aria-label="项目结构"><!--[--><!--]--> 项目结构 <!--[--><!--]--></a></span><span class="next"><a href="/autojs-arknights-ts-doc/gameLogic/" class="" aria-label="游戏处理逻辑"><!--[--><!--]--> 游戏处理逻辑 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/autojs-arknights-ts-doc/assets/app.c897fe6e.js" defer></script>
  </body>
</html>
